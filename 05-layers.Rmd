# Layers {#layers}

<!-- make the order of the table to be consistent with the rest of the chapter! -->

```{r, echo=FALSE}
layers_basic_df = tibble::tribble(
  ~Function, ~Element, ~Geometry,
  "tm_polygons()", "polygons (borders and fill)", "polygons",
  "tm_symbols()", "symbols", "points, polygons, and lines", 
  "tm_lines()", "lines", "lines", 
  "tm_raster()", "raster", "raster",
  "tm_text()", "text", "points, polygons, and lines"
)
layers_extended_df = tibble::tribble(
  ~Function, ~Element, ~Geometry,
  "tm_borders()", "polygons (borders)", "polygons",
  "tm_fill()", "polygons (fill)", "polygons",
  "tm_bubbles()", "bubbles", "points, polygons, and lines",
  "tm_dots()", "dots", "points, polygons, and lines",
  "tm_markers()", "marker symbols", "points, polygons, and lines",
  "tm_square()", "squares", "points, polygons, and lines",
  "tm_iso()", "lines with text labels", "lines",
  "tm_rgb()/tm_rgba()", "raster (RGB image)", "raster"
)
layers_df = rbind(layers_basic_df, 
                  layers_extended_df)
```

\@ref(tab:layers-table)

```{r layers-table, echo=FALSE, warning=FALSE}
library(magrittr)
library(kableExtra)
options(kableExtra.html.bsTable = TRUE)
knitr::kable(layers_df, 
             caption = "Map layers.",
             caption.short = "Map layers.",
             booktabs = TRUE) %>%
  kableExtra::kable_styling("striped",
                            latex_options = "striped", 
                            full_width = FALSE) %>% 
  kableExtra::column_spec(1, bold = TRUE, monospace = TRUE) %>% 
  kableExtra::pack_rows("Basic functions", 1, 5) %>%
  kableExtra::pack_rows("Derived functions", 6, 13)
```

<!--JN: Idea - also add a simple viz showing different kind of layers here (visual summary)-->

## Polygons

```{r, warning=FALSE, message=FALSE}
# replace this data with some new tmap dataset
library(tmap)
library(sf)
file_path = system.file("shapes/world.gpkg", package = "spData")
x = read_sf(file_path)
x = st_transform(x, 8857)
```

```{r, warning=FALSE}
tm_shape(x) +
  tm_polygons()
```

<!--one example of col + ref to the color section in the next chapter-->

<!--one example of fill-->
```{r, warning=FALSE}
tm_shape(x) +
  tm_fill()
```

<!--one example of border-->
```{r, warning=FALSE}
tm_shape(x) +
  tm_borders()
```
## Symbols

```{r}
data("metro", package = "tmap")
# to update later
set.seed(222)
metro2 = metro[sample(1:nrow(metro), 30), ]
```

```{r}
tm_shape(metro2) +
  tm_symbols()
```

<!--explain size, col, shape + ref to a section in the next chapter-->

<!--add info that there are four additional (shortcut) layers-->
<!--explain each additional layer underlining the differences between tm_symbols() and the rest--> 

```{r}
tm_shape(metro2) +
  tm_squares()
```

```{r}
tm_shape(metro2) +
  tm_bubbles()
```

```{r}
tm_shape(metro2) +
  tm_dots()
```

```{r}
tm_shape(metro2) +
  tm_markers()
```

## Lines

```{r}
# replace dataset later
library(tmap)
data("rivers", package = "tmap")
```

```{r}
tm_shape(rivers) + 
  tm_lines()
```

<!-- think about tm_iso example -->

## Text

```{r}
tm_shape(metro2) +
  tm_text(text = "name", size = "pop2020") +
  tm_layout(legend.outside = TRUE)
```

## Raster

```{r}
data(land, package = "tmap")
```

```{r}
tm_shape(land[3]) +
  tm_raster()
```

```{r}
tm_shape(land) +
  tm_raster()
```

## Combining layers

<!-- or maybe start with it and explain the details later? -->